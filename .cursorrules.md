# DoLoop - Cursor AI Rules & Guidelines

## Project Overview

DoLoop is a loop-based productivity app that helps users build momentum through completing recurring tasks. The core innovation is circular progress visualization combined with momentum tracking - NOT gamification with trees, XP, or streaks.

## Core Concept

**"Momentum Through Completion"**
- Loops are recurring task lists that close/complete
- Circular progress indicators visualize completion (the loop metaphor)
- Momentum builds through consistency, not streaks
- Flow state awareness through visual indicators
- Clean, modern aesthetic with purple gradient brand

## Tech Stack

### Frontend
- **Framework:** Next.js 14+ (App Router)
- **Language:** TypeScript (strict mode)
- **Styling:** Tailwind CSS
- **Animations:** Framer Motion
- **Icons:** Lucide React
- **State:** Zustand (when needed)

### Backend (Future)
- **Database:** Supabase (PostgreSQL)
- **Auth:** Supabase Auth
- **API:** Next.js API routes

### Deployment
- **Hosting:** Vercel
- **Database:** Supabase

## Design Principles

### Visual Identity
1. **Circular Progress** - All loops use circular SVG progress indicators
2. **Purple Gradient** - Brand colors: #667eea to #764ba2
3. **Minimal & Clean** - No clutter, generous white space
4. **Momentum Focused** - Visual weight shows consistency, not achievements

### Color Palette
```typescript
const colors = {
  // Brand
  primary: '#667eea',
  primaryDark: '#764ba2',
  
  // Loop Categories
  daily: '#FFB800',    // Orange/Gold
  work: '#00BCD4',     // Cyan
  personal: '#F44336', // Red
  
  // Status
  complete: '#4CAF50', // Green
  pending: '#f0f0f0',  // Light gray
  
  // UI
  background: '#fafafa',
  surface: '#ffffff',
  text: '#000000',
  textSecondary: '#666666',
}
```

### Typography
- **Headings:** Bold, clear hierarchy
- **Body:** 15-16px, line-height 1.5
- **Labels:** 12-13px, uppercase for categories

## Component Guidelines

### File Structure
```
src/
├── app/                    # Next.js pages
│   ├── page.tsx           # Home page
│   ├── loops/             # Loop routes
│   └── momentum/          # Momentum insights
├── components/
│   ├── ui/                # Reusable UI components
│   │   ├── CircularProgress.tsx
│   │   ├── Button.tsx
│   │   └── Card.tsx
│   ├── loops/             # Loop-specific components
│   │   ├── LoopCard.tsx
│   │   └── LoopList.tsx
│   └── layout/            # Layout components
│       ├── Header.tsx
│       └── Navigation.tsx
├── lib/
│   ├── supabase.ts        # Supabase client
│   └── utils/             # Utility functions
├── types/
│   └── index.ts           # TypeScript types
└── store/
    └── loopStore.ts       # Zustand store
```

### Component Standards

#### All Components Must:
1. Use TypeScript with explicit types
2. Use 'use client' directive when needed (interactions, hooks, animations)
3. Follow consistent naming: PascalCase for components
4. Include JSDoc comments for props
5. Use Tailwind for ALL styling (no CSS modules)

#### Example Component Template:
```typescript
'use client';

import { motion } from 'framer-motion';

interface ComponentNameProps {
  /** Description of prop */
  propName: string;
  /** Optional prop with default */
  optionalProp?: boolean;
}

/**
 * Component description
 * @example
 * <ComponentName propName="value" />
 */
export function ComponentName({ 
  propName, 
  optionalProp = false 
}: ComponentNameProps) {
  return (
    <div className="...">
      {/* Component JSX */}
    </div>
  );
}
```

## Coding Standards

### TypeScript
- Use strict mode
- No `any` types
- Explicit return types on functions
- Interfaces over types for objects
- Use `type` for unions and primitives

### React Best Practices
- Functional components only
- Custom hooks for reusable logic (prefix with `use`)
- Avoid prop drilling (use Zustand when needed)
- Memoize expensive calculations with useMemo
- Use useCallback for event handlers passed to children

### Tailwind CSS
- Use utility classes only
- No custom CSS unless absolutely necessary
- Responsive design: mobile-first
- Use Tailwind's spacing scale (4px increments)
- Use Tailwind colors when possible

### File Naming
- Components: `PascalCase.tsx`
- Utilities: `camelCase.ts`
- Hooks: `useCamelCase.ts`
- Types: `index.ts` (one per folder)

### Code Organization
```typescript
// 1. Imports (grouped and sorted)
import { useState } from 'react';
import { motion } from 'framer-motion';

import { Button } from '@/components/ui/Button';
import { Loop } from '@/types';

// 2. Types/Interfaces
interface Props {}

// 3. Component
export function Component() {
  // 3a. Hooks
  const [state, setState] = useState();
  
  // 3b. Event handlers
  const handleClick = () => {};
  
  // 3c. Render
  return <div />;
}
```

## Key Features to Build

### Phase 1: Core UI (Week 1-2)
- [x] CircularProgress component
- [ ] LoopCard component with circular progress
- [ ] Header with purple gradient
- [ ] Home page layout
- [ ] Create loop functionality
- [ ] Task management within loops

### Phase 2: Momentum (Week 3)
- [ ] MomentumVisualization component (7-day dots)
- [ ] FlowStateIndicator (concentric rings)
- [ ] Momentum calculation logic
- [ ] Momentum insights page
- [ ] Loop completion tracking

### Phase 3: Polish (Week 4)
- [ ] Animations with Framer Motion
- [ ] Loading states
- [ ] Empty states
- [ ] Error handling
- [ ] Responsive design
- [ ] Dark mode (optional)

## Data Models

### Loop
```typescript
interface Loop {
  id: string;
  user_id: string;
  name: string;
  description?: string;
  color: string;  // hex color
  reset_rule: 'manual' | 'daily' | 'weekly';
  
  total_tasks: number;
  completed_tasks: number;
  
  completion_count: number;
  last_completed_at?: string;
  current_streak: number;
  
  is_favorite: boolean;
  is_active: boolean;
  
  created_at: string;
  updated_at: string;
}
```

### Task
```typescript
interface Task {
  id: string;
  loop_id: string;
  description: string;
  task_type: 'recurring' | 'one-time';
  status: 'pending' | 'completed' | 'archived';
  task_order: number;
  
  due_date?: string;
  completed_at?: string;
  created_at: string;
  updated_at: string;
}
```

## What NOT to Do

### ❌ Don't Build:
- Trees, forests, or plant metaphors (that's Forest app)
- XP, levels, or RPG elements (that's Habitica)
- Streak flames or fire icons (that's Duolingo)
- Badge systems or achievements (generic gamification)
- Social features (for v1)

### ❌ Don't Use:
- CSS modules or styled-components (Tailwind only)
- Redux (use Zustand if needed)
- Class components (functional only)
- Default exports (named exports preferred)
- Inline styles (Tailwind classes only)

### ❌ Don't Create:
- Overly complex abstractions
- God components (keep them focused)
- Deep prop drilling (flatten or use Zustand)
- Premature optimizations

## Performance Guidelines

1. **Code Splitting**
   - Use dynamic imports for large components
   - Lazy load routes not needed on initial load

2. **Images**
   - Use Next.js Image component
   - Optimize all images before upload
   - Use WebP format when possible

3. **Animations**
   - Use CSS transforms (not position changes)
   - Animate opacity, scale, transforms only
   - Use will-change sparingly

## Accessibility

1. **Semantic HTML**
   - Use proper heading hierarchy
   - Use <button> for clickable elements
   - Use <a> for navigation

2. **ARIA**
   - Add aria-label for icon buttons
   - Use aria-live for dynamic content
   - Include focus states

3. **Keyboard Navigation**
   - All interactive elements keyboard accessible
   - Logical tab order
   - Visible focus indicators

## Testing Strategy

### Manual Testing
- Test on Chrome, Safari, Firefox
- Test on iOS and Android (via browser)
- Test with screen reader (VoiceOver)
- Test all animations at 60fps

### Later: Automated Testing
- Unit tests for utilities
- Integration tests for critical flows
- E2E tests for main user journeys

## Git Workflow

### Commit Messages
```
feat: add CircularProgress component
fix: resolve animation stuttering
refactor: simplify LoopCard logic
docs: update component guidelines
style: format with prettier
```

### Branch Strategy
- `main` - production ready
- `dev` - development branch
- Feature branches: `feat/circular-progress`

## Environment Variables

```bash
# .env.local (not committed)
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
```

## Common Patterns

### Loading State
```typescript
if (loading) {
  return <div className="flex items-center justify-center p-8">
    <div className="animate-spin">Loading...</div>
  </div>;
}
```

### Empty State
```typescript
if (loops.length === 0) {
  return <div className="text-center p-12">
    <p className="text-gray-500">No loops yet.</p>
    <Button onClick={onCreate}>Create your first loop</Button>
  </div>;
}
```

### Error State
```typescript
if (error) {
  return <div className="bg-red-50 border border-red-200 rounded-lg p-4">
    <p className="text-red-800">{error}</p>
  </div>;
}
```

## Questions to Ask Before Building

1. Does this align with the "momentum through completion" concept?
2. Is this the simplest solution?
3. Can this be done with Tailwind instead of custom CSS?
4. Should this be a separate component?
5. Does this need client-side interactivity?
6. Is this accessible?
7. Will this perform well on mobile?

## When In Doubt

- **Keep it simple** - Start with the most straightforward solution
- **Follow the patterns** - Look at existing components for guidance
- **Ask the user** - When unclear, ask for clarification
- **Mobile-first** - Design for mobile, enhance for desktop
- **Accessibility matters** - Never skip semantic HTML

## Success Criteria

A component is done when:
1. ✅ It works correctly
2. ✅ It's typed properly
3. ✅ It's accessible
4. ✅ It's responsive
5. ✅ It performs well
6. ✅ It follows these guidelines
7. ✅ The user is happy with it

---

Remember: DoLoop is about **momentum through completion**. Every design decision should serve that core concept.

